!function(i){"use strict";i.universalAnalytics={dimensionForVersion:void 0,version:void 0,appName:void 0,dimensionForAdditionalLabel:void 0,uaIDs:[],nonInteraction:!0,multiua:function(){if("undefined"==typeof i.FBO||!i.FBO.Config.DisableViewTracking){var n=Array.prototype.slice.call(arguments);if(i.universalAnalytics.uaIDs)for(var a=0,e=i.universalAnalytics.uaIDs.length;a<e;a++){var t=n.slice();t[0]="additional"+a.toString()+"."+t[0],i.universalAnalytics.pushApply(t)}}},fbua:function(){if("undefined"==typeof i.FBO||!i.FBO.Config.DisableViewTracking){var n=Array.prototype.slice.call(arguments);if(i.universalAnalytics.fbIDs)for(var a=0,e=i.universalAnalytics.fbIDs.length;a<e;a++){var t=n.slice();t[0]="additional"+a.toString()+"."+t[0],i.universalAnalytics.pushApply(t)}}},lastApply:(new Date).getTime(),timerId:void 0,tryApply:function(){var n=(new Date).getTime(),a=n-i.universalAnalytics.lastApply;if(a>40){var e=i.universalAnalytics.events.pop();i.ua.apply(null,e),i.universalAnalytics.lastApply=n}i.universalAnalytics.events.length>0?void 0===i.universalAnalytics.timerId&&(i.universalAnalytics.timerId=setInterval(function(){i.universalAnalytics.tryApply()},40)):(clearInterval(i.universalAnalytics.timerId),i.universalAnalytics.timerId=void 0)},pushApply:function(n){i.universalAnalytics.events.push(n),i.universalAnalytics.tryApply()},events:[],ip:void 0,init:function(n,a,e,t,s,l,o,r,c,u){if("undefined"==typeof i.FBO||!i.FBO.Config.DisableViewTracking){null===e&&(e="auto"),i.universalAnalytics.platform=t,i.universalAnalytics.startDate=s,i.universalAnalytics.dimensionForAdditionalLabel=c,i.universalAnalytics.dimensionForVersion=u,i.universalAnalytics.version=l,i.universalAnalytics.appName=r,i.universalAnalytics.fbIDs=n.slice(),i.universalAnalytics.uaIDs=n.concat(a).slice(),function(i,n,a,e,t,s,l){i.GoogleAnalyticsObject=t,i[t]=i[t]||function(){(i[t].q=i[t].q||[]).push(arguments)},i[t].l=1*new Date,s=n.createElement(a),l=n.getElementsByTagName(a)[0],s.async=1,s.src=e,l.parentNode.insertBefore(s,l)}(i,document,"script","//www.google-analytics.com/analytics.js","ua");for(var y=0,d=i.universalAnalytics.uaIDs.length;y<d;y++)i.ua("create",i.universalAnalytics.uaIDs[y],e,{name:"additional"+y.toString(),allowLinker:!0});i.universalAnalytics.multiua("require","displayfeatures"),o===!0?i.universalAnalytics.multiua("set","anonymizeIp",!0):i.universalAnalytics.fbua("set","anonymizeIp",!0),void 0!==i.universalAnalytics.dimensionForVersion&&i.universalAnalytics.multiua("set",i.universalAnalytics.dimensionForVersion,"Version"),void 0!==i.universalAnalytics.dimensionForAdditionalLabel&&i.universalAnalytics.multiua("set",i.universalAnalytics.dimensionForAdditionalLabel,"Additional Label"),i.universalAnalytics.startLoading(),i.universalAnalytics.multiua("require","ecommerce"),i.universalAnalytics.multiua("require","ec")}},getPlatform:function(){return i.universalAnalytics.platform},path:void 0,getPath:function(){if(void 0===i.universalAnalytics.path)if("undefined"!=typeof i.FBO)i.universalAnalytics.path=i.FBO.PreloadedPublicationModel.Publication.HashId+"/";else{if(i.universalAnalytics.path=i.location.pathname,"basic"===i.universalAnalytics.platform){var n=new RegExp("files/assets/basic-html/page.*html");i.universalAnalytics.path=i.universalAnalytics.path.replace(n,"")}i.universalAnalytics.path.length>0&&"/"!==i.universalAnalytics.path.charAt(0)&&(i.universalAnalytics.path="/"+i.universalAnalytics.path);var a=i.universalAnalytics.path.indexOf("index.html");a!==-1&&a+10===i.universalAnalytics.path.length&&(i.universalAnalytics.path=i.universalAnalytics.path.slice(0,a));var a=i.universalAnalytics.path.indexOf("index.htm");a!==-1&&a+9===i.universalAnalytics.path.length&&(i.universalAnalytics.path=i.universalAnalytics.path.slice(0,a))}return i.universalAnalytics.path},transactionID:void 0,deteleTransactionID:function(){delete i.universalAnalytics.transactionID},getTransactionID:function(){return"undefined"==typeof i.universalAnalytics.transactionID&&(i.universalAnalytics.transactionID=(new Date).getTime().toString(36),"undefined"!=typeof i.universalAnalytics.startDate&&(i.universalAnalytics.transactionID+=i.universalAnalytics.startDate.toString(36)),"undefined"!=typeof i.universalAnalytics.openedDate&&(i.universalAnalytics.transactionID+=i.universalAnalytics.openedDate.toString(36))),i.universalAnalytics.transactionID},setCurrency:function(n){i.universalAnalytics.currency=n,i.universalAnalytics.multiua("set","&cu",n)},setShopName:function(n){i.universalAnalytics.shopName=n},addImpression:function(n,a){i.universalAnalytics.multiua("ec:addImpression",{id:a,name:n})},addTransaction:function(n){i.universalAnalytics.multiua("ecommerce:addTransaction",{id:i.universalAnalytics.getTransactionID(),affiliation:i.universalAnalytics.shopName,revenue:n,currency:i.universalAnalytics.currency})},addItem:function(n,a,e,t){i.universalAnalytics.multiua("ecommerce:addItem",{id:i.universalAnalytics.getTransactionID(),name:n,sku:a,price:e,quantity:t}),i.universalAnalytics.multiua("ec:addProduct",{id:a,name:n})},purchase:function(n){i.universalAnalytics.multiua("ecommerce:send"),i.universalAnalytics.multiua("ec:setAction","purchase",{id:i.universalAnalytics.getTransactionID(),revenue:n}),i.universalAnalytics.deteleTransactionID()},shareByFacebook:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Facebook","Share",n)},shareByGooglePlus:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Google+","Share",n)},shareByLinkedin:function(n){i.ua&&i.universalAnalytics.multiua("send","social","LinkedIn","Share",n)},shareByTumblr:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Tumblr","Share",n)},shareByVK:function(n){i.ua&&i.universalAnalytics.multiua("send","social","VK","Share",n)},shareByBlogger:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Blogger","Share",n)},tweet:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Twitter","Tweet",n)},shareByEmail:function(n){i.ua&&i.universalAnalytics.multiua("send","social","Email","Mail",n)},shareByMySpace:function(n){i.ua&&i.universalAnalytics.multiua("send","social","MySpace","Share",n)},dispatch:function(n,a,e,t,s){var l={};void 0!==e&&(l.eventLabel=e),void 0!==t&&(l.eventValue=t),i.universalAnalytics.nonInteraction&&(l.nonInteraction=!0),void 0!==s&&void 0!==i.universalAnalytics.dimensionForAdditionalLabel&&(l[i.universalAnalytics.dimensionForAdditionalLabel]=s),void 0!==i.universalAnalytics.dimensionForVersion&&(l[i.universalAnalytics.dimensionForVersion]=i.universalAnalytics.version),l.page=i.universalAnalytics.getPath(),i.ua&&i.universalAnalytics.multiua("send","event",n,a,l)},fbDispatch:function(n,a,e,t,s){var l={};void 0!==e&&(l.eventLabel=e),void 0!==t&&(l.eventValue=t),i.universalAnalytics.nonInteraction&&(l.nonInteraction=!0),void 0!==s&&void 0!==i.universalAnalytics.dimensionForAdditionalLabel&&(l[i.universalAnalytics.dimensionForAdditionalLabel]=s),void 0!==i.universalAnalytics.dimensionForVersion&&(l[i.universalAnalytics.dimensionForVersion]=i.universalAnalytics.version),l.page=i.universalAnalytics.getPath(),i.ua&&i.universalAnalytics.fbua("send","event",n,a,l)},zoomIn:function(n,a){i.universalAnalytics.dispatch("Zoom","Zoom In",a,void 0,n)},zoomOut:function(n,a){i.universalAnalytics.dispatch("Zoom","Zoom Out",a,void 0,n)},zoomBlock:function(n){i.universalAnalytics.dispatch("Zoom","Zoom Block",n)},openWindow:function(n,a){i.universalAnalytics.dispatch(n,"Open",a)},closeWindow:function(n,a){i.universalAnalytics.dispatch(n,"Close",a)},print:function(n,a){i.universalAnalytics.dispatch("Print","Print",a,void 0,n)},clickImage:function(n){i.universalAnalytics.dispatch("Image","Click",n)},imageLoaded:function(n){i.universalAnalytics.dispatch("Image","Loaded",n)},download:function(n,a){i.universalAnalytics.dispatch("Download","Download",n,void 0,a)},videoPlay:function(n,a){i.universalAnalytics.dispatch("Video","Play",n,void 0,a)},videoPause:function(n,a){i.universalAnalytics.dispatch("Video","Pause",n,void 0,a)},videoStop:function(n,a){i.universalAnalytics.dispatch("Video","Stop",n,void 0,a)},videoSeekTo:function(n,a){i.universalAnalytics.dispatch("Video","SeekTo",n,void 0,a)},fullscreenOn:function(n){i.universalAnalytics.dispatch("Fullscreen","On",n)},fullscreenOff:function(n){i.universalAnalytics.dispatch("Fullscreen","Off",n)},slideshowStart:function(){i.universalAnalytics.dispatch("Slideshow","Start")},slideshowStop:function(){i.universalAnalytics.dispatch("Slideshow","Stop")},soundOn:function(){i.universalAnalytics.dispatch("Sound","On")},soundOff:function(){i.universalAnalytics.dispatch("Sound","Off")},addBookmark:function(n,a){i.universalAnalytics.dispatch("Bookmarks","Add",a,void 0,n)},removeBookmark:function(n,a){i.universalAnalytics.dispatch("Bookmarks","Remove",a,void 0,n)},productLink:function(n,a,e){var t="undefined"==typeof a?e:a;i.universalAnalytics.dispatch("Link","Product",n,void 0,t)},externalLink:function(n,a){i.universalAnalytics.dispatch("Link","External",n,void 0,a)},internalLink:function(n,a){i.universalAnalytics.dispatch("Link","Internal",n,void 0,a)},search:function(n){i.universalAnalytics.dispatch("Search","Search",n)},textSelect:function(n){i.universalAnalytics.dispatch("TextSelection","Select",n)},textCopy:function(n){i.universalAnalytics.dispatch("TextSelection","Copy",n)},startLoading:function(){i.universalAnalytics.dispatch("Loading","Start",i.universalAnalytics.getPlatform())},openedDate:void 0,publicationOpened:function(){i.universalAnalytics.openedDate=(new Date).getTime(),i.universalAnalytics.dispatch("Loading","Open",i.universalAnalytics.getPlatform(),void 0,i.universalAnalytics.openedDate-i.universalAnalytics.startDate),i.universalAnalytics.sendApplicationTiming(i.universalAnalytics.openedDate-i.universalAnalytics.startDate),i.universalAnalytics.sendFBTiming("Application Load 2",i.universalAnalytics.openedDate-i.universalAnalytics.startDate),i.universalAnalytics.nonInteraction=!1},preloaderLoaded:function(){i.universalAnalytics.preloaderDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Preloader Load",i.universalAnalytics.preloaderDate-i.universalAnalytics.startDate)},preloaderDate:void 0,startFlippingBookLoad:function(){i.universalAnalytics.startFlippingBookDate=(new Date).getTime()},startFlippingBookDate:void 0,endFlippingBookLoad:function(){i.universalAnalytics.endFlippingBookDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Style Load",i.universalAnalytics.endFlippingBookDate-i.universalAnalytics.startFlippingBookDate)},endFlippingBookDate:void 0,startStyleLoad:function(){i.universalAnalytics.startStyleDate=(new Date).getTime()},startStyleDate:void 0,endStyleLoad:function(){i.universalAnalytics.endStyleDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Style Load",i.universalAnalytics.endStyleDate-i.universalAnalytics.startStyleDate)},endStyleDate:void 0,startPropertyLoad:function(){i.universalAnalytics.startPropertyDate=(new Date).getTime()},startPropertyDate:void 0,endPropertyLoad:function(){i.universalAnalytics.endPropertyDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Property Load",i.universalAnalytics.endPropertyDate-i.universalAnalytics.startPropertyDate)},endPropertyDate:void 0,startStyleXmlLoad:function(){i.universalAnalytics.startStyleXmlDate=(new Date).getTime()},startStyleXmlDate:void 0,endStyleXmlLoad:function(){i.universalAnalytics.endStyleXmlDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Style xml Load",i.universalAnalytics.endStyleXmlDate-i.universalAnalytics.startStyleXmlDate)},endStyleXmlDate:void 0,startFontLoad:function(){i.universalAnalytics.startFontDate=(new Date).getTime()},startFontDate:void 0,endFontLoad:function(){i.universalAnalytics.endFontDate=(new Date).getTime(),i.universalAnalytics.sendFBTiming("Font Load",i.universalAnalytics.endFontDate-i.universalAnalytics.startFontDate)},endFontDate:void 0,previousPage:void 0,previousPage2:void 0,pageView:function(n){var a=i.universalAnalytics.getPath(),e="undefined"!=typeof FBO?n:"#"+n;i.ua&&i.universalAnalytics.multiua("send","pageview",{page:a+e})},flipToLastPage:function(n){i.universalAnalytics.fbDispatch("Pages","Last Page",n)},flipToFirstPage:function(n){i.universalAnalytics.fbDispatch("Pages","First Page",n)},openInSlide:function(n,a){"Start Book"!==n&&i.universalAnalytics.dispatch("Pages","OpenInSlide",a,void 0,n),i.universalAnalytics.previousPage!==a&&i.universalAnalytics.previousPage2!==a&&(i.universalAnalytics.pageView(a),a%2===0?i.universalAnalytics.previousPage=a:i.universalAnalytics.previousPage2=a)},openInSpread:function(n,a,e){"Start Book"!==n&&i.universalAnalytics.dispatch("Pages","OpenInSpread",a,void 0,n),a!==i.universalAnalytics.previousPage&&a!==i.universalAnalytics.previousPage2&&i.universalAnalytics.pageView(a),e&&(i.universalAnalytics.dispatch("Pages","OpenInSpread",e,void 0,n),e!==i.universalAnalytics.previousPage&&e!==i.universalAnalytics.previousPage2&&i.universalAnalytics.pageView(e),i.universalAnalytics.previousPage2=e),i.universalAnalytics.previousPage=a},sendTiming:function(n,a,e){i.ua&&i.universalAnalytics.multiua("send","timing",i.universalAnalytics.getPlatform(),n,a,e)},sendFBTiming:function(n,a,e){i.ua&&i.universalAnalytics.fbua("send","timing",i.universalAnalytics.getPlatform(),n,a,e)},sendApplicationTiming:function(n){i.universalAnalytics.sendTiming("Application Load",n)},sendPageTiming:function(n,a){i.universalAnalytics.sendTiming("Page Load",n,a)},sendSlideTiming:function(n,a){i.universalAnalytics.sendTiming("Slide Load",n,a)},sendThumbnailTiming:function(n,a){i.universalAnalytics.sendTiming("Thumbnail Load",n,a)},sendFatalError:function(n,a){i.ua&&i.universalAnalytics.multiua("send","exception",{exDescription:n,exFatal:!0,appName:i.universalAnalytics.appName,appVersion:i.universalAnalytics.version}),i.universalAnalytics.dispatch("Error","Fatal",n,void 0,a)},sendError:function(n,a){i.ua&&i.universalAnalytics.multiua("send","exception",{exDescription:n,exFatal:!1,appName:i.universalAnalytics.appName,appVersion:i.universalAnalytics.version}),i.universalAnalytics.dispatch("Error","Non Fatal",n,void 0,a)}}}(this),function(i,n){"use strict";"undefined"!=typeof exports?i(global,exports):i(n,n)}(function(i,n){"use strict";function a(){if(i.universalAnalytics)this.analytics=i.universalAnalytics;else var n=this,a=setTimeout(function e(){i.universalAnalytics?(n.analytics=i.universalAnalytics,n.tryToSubscribe()):a=setTimeout(e,200)},200)}function e(i){return"function"==typeof i||!1}var t=["page","goToFirstPage","goToLastPage","zoom","slideshow","link","image","video","sound","window","share","print","download","fullscreen","search","timing"];a.prototype.subscribe=function(i){this.evt=i,this.tryToSubscribe()},a.prototype.tryToSubscribe=function(){if(this.analytics&&this.evt&&e(this.evt.on))for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];this.evt.on(n,this[n],this)}},a.prototype.page=function(i){"openInSlide"===i.action?this.analytics.openInSlide(void 0,i.pageNumber):"openInSpread"===i.action&&this.analytics.openInSpread(void 0,i.pageNumberLeft,i.pageNumberRight)},a.prototype.goToFirstPage=function(){this.analytics.flipToFirstPage(void 0)},a.prototype.goToLastPage=function(){this.analytics.flipToLastPage(void 0)},a.prototype.zoom=function(i){"Zoom In"===i.action?this.analytics.zoomIn(void 0,i.pageNumber):"Zoom Out"===i.action&&this.analytics.zoomOut(void 0,i.pageNumber)},a.prototype.slideshow=function(i){"Start"===i.action?this.analytics.slideshowStart():"Stop"===i.action&&this.analytics.slideshowStop()},a.prototype.link=function(i){"Internal"===i.action?this.analytics.internalLink(i.pageTo,i.pageNumber):"External"===i.action&&this.analytics.externalLink(i.url,i.pageNumber,i.target)},a.prototype.image=function(i){"Loaded"===i.action?this.analytics.imageLoaded(i.url):"Click"===i.action&&this.analytics.clickImage(i.url)},a.prototype.video=function(i){"Play"===i.action?this.analytics.videoPlay(i.url,i.time):"Pause"===i.action?this.analytics.videoPause(i.url,i.time):"Stop"===i.action?this.analytics.videoStop(i.url,i.time):"SeekTo"===i.action&&this.analytics.videoSeekTo(i.url,i.time)},a.prototype.sound=function(i){"On"===i.action?this.analytics.soundOn():"Off"===i.action&&this.analytics.soundOff()},a.prototype.window=function(i){"Open"===i.action?this.analytics.openWindow(i.component):"Close"===i.action&&this.analytics.closeWindow(i.component)},a.prototype.share=function(i){"Facebook"===i.service?this.analytics.shareByFacebook(i.url):"Twitter"===i.service?this.analytics.tweet(i.url):"LinkedIn"===i.service?this.analytics.shareByLinkedin(i.url):"Tumblr"===i.service?this.analytics.shareByTumblr(i.url):"Google+"===i.service?this.analytics.shareByGooglePlus(i.url):"Email"===i.service?this.analytics.shareByEmail(i.url):"VK"===i.service&&this.analytics.shareByVK(i.url)},a.prototype.print=function(i){for(var n in i.pageNumbers)if(i.pageNumbers.hasOwnProperty(n)){var a=i.pageNumbers[n];this.analytics.print(i.option,a)}},a.prototype.download=function(i){this.analytics.download(i.url,i.option)},a.prototype.fullscreen=function(i){"On"===i.action?this.analytics.fullscreenOn():"Off"===i.action&&this.analytics.fullscreenOff()},a.prototype.search=function(i){this.analytics.search(i.query)},a.prototype.timing=function(i){"publicationOpened"===i.type&&this.analytics.publicationOpened()},n.UniversalAnalytics=a},this);